<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì½”ëƒ ê²Œì„ì¦ˆ ê´€ë¦¬ - ì „ì²´í™”ë©´</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #4dabf7; --bg: #f8f9fa; --success: #28a745; --danger: #dc3545; }
        body { margin: 0; font-family: 'Pretendard', sans-serif; background: var(--bg); color: #333; }
        
        /* ìƒë‹¨ ë’¤ë¡œê°€ê¸° ë°” */
        .top-nav { 
            background: #1a1d21; color: white; padding: 12px 25px; 
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 100;
        }
        .back-btn { 
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); 
            color: white; padding: 7px 15px; border-radius: 6px; cursor: pointer; font-size: 13px;
            transition: 0.2s; display: flex; align-items: center; gap: 8px;
        }
        .back-btn:hover { background: rgba(255,255,255,0.2); }

        /* ë©”ì¸ ì»¨í…ì¸  (ì™¼ìª½ ì—¬ë°± ì‚­ì œ) */
        main { padding: 30px; max-width: 1200px; margin: 0 auto; }
        .section-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        
        .header-flex { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #f1f3f5; padding: 12px; text-align: left; font-size: 13px; }
        td { padding: 10px; border-bottom: 1px solid #eee; font-size: 14px; }
        
        input { padding: 8px; border: 1px solid #ddd; border-radius: 5px; width: 100%; box-sizing: border-box; }
        .btn { padding: 10px 18px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; }
        .btn-save { background: var(--primary); color: white; }
        .btn-add { background: #e67e22; color: white; }
        
        .tab-menu { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab-btn { padding: 10px 20px; background: #e9ecef; border-radius: 8px; cursor: pointer; border: none; font-weight: bold; }
        .tab-btn.active { background: var(--primary); color: white; }
    </style>
</head>
<body>

    <div class="top-nav">
        <button class="back-btn" onclick="location.href='index.html'">
            <i class="fas fa-arrow-left"></i> ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°
        </button>
        <span style="font-size: 14px; font-weight: bold; color: var(--primary);">codetbase ê²Œì„ ê´€ë¦¬ ì‹œìŠ¤í…œ</span>
    </div>

    <main>
        <div class="header-flex">
            <h1>ğŸ® ê²Œì„ í†µí•© ì„¤ì •</h1>
            <button class="btn btn-save" onclick="saveAllData()">ëª¨ë“  ë°ì´í„° ì €ì¥</button>
        </div>

        <div class="tab-menu">
            <button class="tab-btn active" onclick="switchTab('sword')">âš”ï¸ ê²€ ë°ì´í„°</button>
            <button class="tab-btn" onclick="switchTab('code')">ğŸ ë³´ìƒ ì½”ë“œ</button>
            <button class="tab-btn" onclick="switchTab('user')">ğŸ‘¥ ìœ ì € ê´€ë¦¬</button>
        </div>

        <div id="tab-sword" class="section-card">
            <div class="header-flex"><h3>ê°•í™” íŠ¸ë¦¬ ì„¤ì •</h3><button class="btn btn-add" onclick="addSword()">+ ì¶”ê°€</button></div>
            <table id="sword-table">
                <thead><tr><th width="50">Lv</th><th>ì´ë¦„</th><th>ê°•í™”ë¹„</th><th>í™•ë¥ </th><th>ì‚­ì œ</th></tr></thead>
                <tbody id="sword-body"></tbody>
            </table>
        </div>

        <div id="tab-code" class="section-card" style="display:none;">
            <div class="header-flex"><h3>ì¿ í° ì½”ë“œ ë°œê¸‰</h3><button class="btn btn-add" onclick="addCode()">+ ì‹ ê·œ</button></div>
            <table>
                <thead><tr><th>ì½”ë“œ</th><th>ê³¨ë“œ</th><th>ìˆ˜ëŸ‰</th><th>ì œí•œ</th><th>ì‚­ì œ</th></tr></thead>
                <tbody id="code-body"></tbody>
            </table>
        </div>

        <div id="tab-user" class="section-card" style="display:none;">
            <h3>ìœ ì € ì‹¤ì‹œê°„ ê´€ë¦¬</h3>
            <table style="margin-top:15px;">
                <thead><tr><th>ë‹‰ë„¤ì„</th><th>ê³¨ë“œ</th><th>ìƒíƒœ</th><th>ì‘ì—…</th></tr></thead>
                <tbody id="user-body"></tbody>
            </table>
        </div>
    </main>

    <script>
        const GAME_URL = "https://utfrjzcnefsbuadnkdud.supabase.co";
        const GAME_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0ZnJqemNuZWZzYnVhZG5rZHVkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY4MjE1MTYsImV4cCI6MjA4MjM5NzUxNn0.D3Za1nMw-x0JwOpkFuYceUHlagcpRdrpFqNUIP5Kjdc";
        const _gameClient = supabase.createClient(GAME_URL, GAME_KEY);

        let swordData = [], codeData = [], userData = [];

        async function load() {
            const { data: s } = await _gameClient.from('sword_data').select('*').order('level');
            const { data: c } = await _gameClient.from('reward_codes').select('*');
            const { data: u } = await _gameClient.from('profiles').select('*').limit(20);
            swordData = s || []; codeData = c || []; userData = u || [];
            render();
        }

        function render() {
            document.getElementById('sword-body').innerHTML = swordData.map((s, i) => `
                <tr>
                    <td>${s.level}</td>
                    <td><input type="text" value="${s.name}" onchange="swordData[${i}].name=this.value"></td>
                    <td><input type="number" value="${s.upgrade_cost}" onchange="swordData[${i}].upgrade_cost=this.value"></td>
                    <td><input type="number" step="0.1" value="${s.success_rate}" onchange="swordData[${i}].success_rate=this.value"></td>
                    <td><button onclick="swordData.splice(${i},1);render()">X</button></td>
                </tr>
            `).join('');
            
            // ì½”ë“œ ë° ìœ ì € ë Œë”ë§ ìƒëµ (ê¸°ì¡´ ë¡œì§ê³¼ ë™ì¼)
        }

        function switchTab(t) {
            document.querySelectorAll('.section-card').forEach(s => s.style.display = 'none');
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-'+t).style.display = 'block';
            event.target.classList.add('active');
        }

        async function saveAllData() {
            // ì €ì¥ ë¡œì§ (ì´ì „ ì œê³µ ì½”ë“œì™€ ë™ì¼)
            alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");
        }

        load();
    </script>
</body>
</html>
